<template>
  <div class='wrap'>
    <div class="search-bar">
      <i v-if='isReturn' @click='setReturn' class="fas fa-undo-alt"></i>
      <transition name='fade' mode="out-in">
        <i key=1 v-if='isHashSearch' :style='`color:${iconColor}`' @click='setHash' class="fas fa-hashtag"></i>
        <i key=2 v-else class="fas fa-user" :style='`color:${iconColor}`'></i>
      </transition>
      <i v-show='isUserSearch' @click='setUser' class="fas fa-user search-user-icon"></i>
      <input @input="hashContent = $event.target.value" v-model='hashContent' 
        v-show='isHashInput' @keypress.enter='onHashResult' @keyup.188="addHash" type="text" class="search-input" placeholder=" , 를 통해 구분해주세요">
      <span v-show='isHashInput'>
        <i @click='onHashResult' class="fab inner-search-btn fa-sistrix"></i>
      </span>
      <input @input="userContent = $event.target.value" v-model='userContent' 
        v-show='isUserInput' @keypress.enter='onUserResult' type="text" class="search-input" placeholder="유저이름을 입력하세요">
      <span v-show='isUserInput'>
        <i @click='onUserResult' class="fab inner-search-btn fa-sistrix"></i>
      </span>
      <transition-group name='fade' tag="div" class="hash-group" mode="in-out">
        <div class='hash-item' v-for='(hash, index) in hashList' :key='`hash-${index}`'>
          <div @click='delHashItem(index)' class="hash-item-close-btn"><i class="fas fa-times"></i></div>
          {{ hash }}
        </div>
      </transition-group>
    </div>

    <div v-if="isDefault" class='wrap-container search-container'>

      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/115999683_208712917242400_7853725733733513666_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=104&_nc_ohc=AvPIi_dvY8YAX9_vvo7&oh=33cf0cb25092a6bda81d298f097107dd&oe=5F4DE678" alt="">
        </div>
        <SearchModal v-if="showModal" @close="showModal= false"/>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/c0.25.1440.1440a/s640x640/116404648_153039273082921_5182030600312684607_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=101&_nc_ohc=IBpQweG5lHMAX_QSmWF&oh=5c3ef3b19e8d9df0f4e1b28922208630&oe=5F4A8DBF" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/c0.180.1440.1440a/s640x640/115908392_3143316965736561_5295481708585333350_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=plvc2NP7j5AAX-XaM0C&oh=db8994197f977d6a53393c8122811946&oe=5F4DA6CB" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/e35/116363553_752834785516476_1926326966447616076_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=100&_nc_ohc=OQtQ2R5KUcwAX-dbIaU&oh=e0b1affcf56a2cdf469c6339ae1af958&oe=5F4D1E40" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/c5.0.1069.1069a/s640x640/116258824_768107933923433_7405040603524361891_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=105&_nc_ohc=8_VGBuiEN-4AX_3Sxon&oh=c3b5b0dc3d977c8c1ef5014fb0e8075a&oe=5F4D7643" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/e35/116592429_1139437373095582_3420540484434190690_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=110&_nc_ohc=rYAxs7P8CVoAX_E0Hwf&oh=c5cc8b2e3a48d679177594901f603aa6&oe=5F4A9ACC" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/e35/116328862_289433112117542_7542864421156657669_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=102&_nc_ohc=YuC-qqESf-wAX-CiGoE&oh=cc30844440724a9856cf4ea0307cfdf9&oe=5F4C92E6" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/e35/116340371_573653673326588_4109177457182452730_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=108&_nc_ohc=A3LQGhrDZiQAX_HJ-ye&oh=1fa6e2c2a41621fdb093c58ade12bb12&oe=5F4BF43F" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/e35/115907077_990834288004690_2656502429638811500_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=110&_nc_ohc=s57L4UMgJLsAX8St89P&oh=945a14bc80ecb6137d969d46329af174&oe=5F4DBAE5" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116473579_2695116987444102_90220358719912267_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=106&_nc_ohc=aHiKsGVQZWIAX8O46An&oh=69fdb8ae2cb580c65dbd10f8c6646158&oe=5F4C8B47" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116049969_1434087843442893_1447786432385798003_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=kNvn88lz7ssAX_WoY6D&oh=56d0fdfdbc6720c51ef2e64e42a9f7e6&oe=5F4BE581" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116266169_338416570508927_1633965425111792034_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=111&_nc_ohc=j3qT-_BzercAX9-FKaT&oh=0830e3111f252b5eb124fbf5cfa0df58&oe=5F4AA8B4" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116473579_2695116987444102_90220358719912267_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=106&_nc_ohc=aHiKsGVQZWIAX8O46An&oh=69fdb8ae2cb580c65dbd10f8c6646158&oe=5F4C8B47" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116049969_1434087843442893_1447786432385798003_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=kNvn88lz7ssAX_WoY6D&oh=56d0fdfdbc6720c51ef2e64e42a9f7e6&oe=5F4BE581" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116266169_338416570508927_1633965425111792034_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=111&_nc_ohc=j3qT-_BzercAX9-FKaT&oh=0830e3111f252b5eb124fbf5cfa0df58&oe=5F4AA8B4" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116473579_2695116987444102_90220358719912267_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=106&_nc_ohc=aHiKsGVQZWIAX8O46An&oh=69fdb8ae2cb580c65dbd10f8c6646158&oe=5F4C8B47" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116049969_1434087843442893_1447786432385798003_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=kNvn88lz7ssAX_WoY6D&oh=56d0fdfdbc6720c51ef2e64e42a9f7e6&oe=5F4BE581" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116266169_338416570508927_1633965425111792034_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=111&_nc_ohc=j3qT-_BzercAX9-FKaT&oh=0830e3111f252b5eb124fbf5cfa0df58&oe=5F4AA8B4" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116473579_2695116987444102_90220358719912267_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=106&_nc_ohc=aHiKsGVQZWIAX8O46An&oh=69fdb8ae2cb580c65dbd10f8c6646158&oe=5F4C8B47" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116049969_1434087843442893_1447786432385798003_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=kNvn88lz7ssAX_WoY6D&oh=56d0fdfdbc6720c51ef2e64e42a9f7e6&oe=5F4BE581" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116266169_338416570508927_1633965425111792034_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=111&_nc_ohc=j3qT-_BzercAX9-FKaT&oh=0830e3111f252b5eb124fbf5cfa0df58&oe=5F4AA8B4" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116473579_2695116987444102_90220358719912267_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=106&_nc_ohc=aHiKsGVQZWIAX8O46An&oh=69fdb8ae2cb580c65dbd10f8c6646158&oe=5F4C8B47" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116049969_1434087843442893_1447786432385798003_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=kNvn88lz7ssAX_WoY6D&oh=56d0fdfdbc6720c51ef2e64e42a9f7e6&oe=5F4BE581" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116266169_338416570508927_1633965425111792034_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=111&_nc_ohc=j3qT-_BzercAX9-FKaT&oh=0830e3111f252b5eb124fbf5cfa0df58&oe=5F4AA8B4" alt="">
        </div>
      </div>
      <div class="search-box">
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116473579_2695116987444102_90220358719912267_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=106&_nc_ohc=aHiKsGVQZWIAX8O46An&oh=69fdb8ae2cb580c65dbd10f8c6646158&oe=5F4C8B47" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116049969_1434087843442893_1447786432385798003_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=109&_nc_ohc=kNvn88lz7ssAX_WoY6D&oh=56d0fdfdbc6720c51ef2e64e42a9f7e6&oe=5F4BE581" alt="">
        </div>
        <div class="search-inner-box">
          <div @click="onModal" class="search-inner-btn">자세히</div>
          <img src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-15/sh0.08/e35/s640x640/116266169_338416570508927_1633965425111792034_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_cat=111&_nc_ohc=j3qT-_BzercAX9-FKaT&oh=0830e3111f252b5eb124fbf5cfa0df58&oe=5F4AA8B4" alt="">
        </div>
      </div>
      
    </div>
    <HashSearch v-if="isHashResult"></HashSearch>
    <UserSearch v-if="isUserResult"></UserSearch>
  </div>
</template>

<script>
import { mapState } from 'vuex'
import HashSearch from '../components/HashSearch.vue'
import UserSearch from '../components/UserSearch.vue'
import SearchModal from '../components/SearchModal.vue'
import '../components/css/search.css'

export default {
  name: 'Search',
  computed: {
    ...mapState(['flag'])
  },
  components: {
    HashSearch,
    UserSearch,
    SearchModal,
  },
  data() {
    return {
      isHashSearch: true,
      isUserSearch: true,
      isReturn: false,
      isHashInput: false,
      isUserInput: false,
      hashContent: '',
      hashList: [],
      userContent: '',
      isDefault: true,
      isHashResult: false,
      isUserResult: false,
      iconColor: '',
      showModal: false,
      settings: {
        "dots": true,
        "arrows": false,
        "dotsClass": "slick-dots custom-dot-class",
        "edgeFriction": 0.35,
        "infinite": false,
        "speed": 500,
        "slidesToShow": 1,
        "slidesToScroll": 1
      },
    }
  },
  watch: {
    hashContent() {
      this.checkHashTag();
    },
    flag() {
      this.defaultDark()
    }
  },
  methods: {
    goSearch() {
        const selectBar = document.querySelector('.menu-bar-select')
        const newsFeed = document.querySelector('.fa-newspaper')
        const search = document.querySelector('.fa-search')
        const community = document.querySelector('.fa-users')
        newsFeed.style.color = 'grey'
        search.style.color = 'black'
        community.style.color = 'grey'
        selectBar.classList.add('go-second-menu')
        selectBar.classList.remove('go-first-menu')
        selectBar.classList.remove('go-third-menu')
      },
    setHash() {
      // const HASH = document.querySelector('.fa-hashtag')
      // HASH.style.paddingRight = '50%'
      this.isUserSearch = false
      this.isHashInput = true
      this.isReturn = true
    },
    setUser() {
      // const USER = document.querySelector('.fa-user')
      // USER.style.paddingRight = '80%'
      this.isHashSearch = false
      this.isUserSearch = false
      this.isUserInput = true
      this.isReturn = true
    },
    setReturn() {
      this.isHashSearch = !this.isHashSearch
      this.hashList = []
      if(this.isUserInput) {
        this.isUserInput = false
        this.isHashInput = true
        this.hashContent = null
      } else if (this.isHashInput) {
        this.isHashInput = false
        this.isUserInput = true
        this.userContent = null
      }
    },
    checkHashTag() {
      
    },
    addHash() {
      this.hashList.push(this.hashContent.slice(0,-1))
      this.hashContent = ''
    },
    delHashItem(index) {
      this.hashList.splice(index, 1)
    },
    onHashResult() {
      this.isDefault = false
      this.isUserResult = false
      this.isHashResult = true
    },
    onUserResult() {
      this.isDefault = false
      this.isHashResult = false
      this.isUserResult = true
    },
    defaultDark() {
      const Dark = this.$cookies.get('dark')
      const HTML = document.querySelector('html')
      const wrap = document.querySelector('.wrap')
      const INPUT = document.querySelectorAll('.search-input')

      const SEARCH_ICON = document.querySelectorAll('.fa-sistrix')
      const USERICON = document.querySelector('.search-user-icon')
      if (Dark === null) {
        this.$cookies.set('dark', 'on')
      }

      if (Dark === 'off') {
        HTML.classList.add('black')
        wrap.classList.add('wrap-dark')
        USERICON.classList.add('search-icon-black')
        this.iconColor = '#ebebeb'
        for (let i=0; i<INPUT.length ; i++) {
          SEARCH_ICON[i].classList.add('search-icon-black')
        }
        for (let i=0; i<INPUT.length ; i++) {
          INPUT[i].classList.add('search-input-dark')
        }
      } else {
        HTML.classList.remove('black')
        wrap.classList.remove('wrap-dark')
        USERICON.classList.remove('search-icon-black')
        this.iconColor = 'black'
        for (let i=0; i<INPUT.length ; i++) {
          SEARCH_ICON[i].classList.remove('search-icon-black')
        }
        for (let i=0; i<INPUT.length ; i++) {
          INPUT[i].classList.remove('search-input-dark')
        }
      }
    },
    onModal() {
      this.showModal = true
    }
  },
  mounted() {
    this.goSearch()
    this.defaultDark()
  }
}
</script>